<!DOCTYPE html>
<html id="docs" lang="en" class="">
	<head>
	<meta charset="utf-8">
<title>Run conditions on pipeline - CDS - Continuous Delivery Service</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="shortcut icon" type="image/png" href="../../../../images/favicon.png">




<link rel="stylesheet" href="../../../../sass/styles.css" integrity="" media="screen">
<link rel="stylesheet" href="../../../../css/callouts.css">
<link rel="stylesheet" href="../../../../css/auto-complete.css">
<link rel="stylesheet" href="../../../../css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../css/asciinema-player.css">
<link rel="stylesheet" href="../../../../css/solarized-light.css">

<meta name="description"
    content="In CDS if you want to launch a pipeline in your workflow only in specific cases you can add conditions. For example, if you want to run a pipeline automatically only if the value of git.branch is master.
To edit your pipeline condition on the user interface, you have to select a node under edition mode of your workflow and click on Edit run conditions like this:
There are 2 types of conditions:">
<meta property="og:description"
    content="In CDS if you want to launch a pipeline in your workflow only in specific cases you can add conditions. For example, if you want to run a pipeline automatically only if the value of git.branch is master.
To edit your pipeline condition on the user interface, you have to select a node under edition mode of your workflow and click on Edit run conditions like this:
There are 2 types of conditions:">
<meta name="twitter:description"
    content="In CDS if you want to launch a pipeline in your workflow only in specific cases you can add conditions. For example, if you want to run a pipeline automatically only if the value of git.branch is master.
To edit your pipeline condition on the user interface, you have to select a node under edition mode of your workflow and click on Edit run conditions like this:
There are 2 types of conditions:">
<meta property="og:url" content="/docs/concepts/workflow/run-conditions/">
<meta property="og:title" content="Run conditions on pipeline">
<meta name="twitter:title" content="Run conditions on pipeline">
<meta name="twitter:image:alt" content="CDS - Continuous Delivery Service">
<meta property="og:image" content="/images/cds-transparent.png">
<script type="text/javascript" src="../../../../js/anchor.min.js"></script>
<script type="text/javascript" src="../../../../js/jquery.min.js"></script>
<script type="text/javascript" src="../../../../js/jquery-ui.min.js"></script>
<script type="text/javascript" src="../../../../js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../../../js/highlight.pack.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>
<script type="text/javascript" src="../../../../js/script.js"></script>
<script type="text/javascript" src="../../../../js/lunr.min.js"></script>
<a id="indexJSON" href="../../../../index.json"></a>

<script type="text/javascript" src="../../../../js/auto-complete.min.js"></script>
<script type="text/javascript" src="../../../../js/search.js"></script>
<script type="text/javascript" src="../../../../js/asciinema-player.min.js"></script>

	</head>
	<body>
		<section id="hero" class="light-text no-sub">
			<a href="../../../../" class="logo"></a>
				<i id="tocburger" class="fa fa-bars" onclick='$("#toc").toggle()'></i><div class="nav-buttons" data-auto-burger="primary">
				<ul class="global-nav">
					
					
					<li><a href="../../../../docs/" class="active">Documentation</a></li>
					
					<li><a href="../../../../hosting/">Hosting your own instance</a></li>
					
					<li><a href="../../../../development/">CDS Developer Manual</a></li>
					
					<li><a href="../../../../about/">About</a></li>
					
					<li><i class="fa fa-search" onclick='$("#searchbox").toggle(); $("#search-query").focus().select()'></i></li>
					<li>
						<div id="btn-gh">
							<a class="github-button" href="https://github.com/ovh/cds" data-icon="octicon-star" data-size="large" data-show-count="true" aria-label="Star CDS on GitHub">Star</a>
							<script async defer src="https://buttons.github.io/buttons.js"></script>
						</div>
					</li>
				</ul>
				<div id="searchbox">
					<input data-search-input id="search-query" type="text" placeholder="search...">
					<span data-search-clear=""><i class="fa fa-close"></i></span>
				</div>
			</div>

<div id="headSubMenu" class="light-text">




	

		

		
		<ul>
			
			
			
			<li><a href="../../../../docs/">Home</a></li>
			
			
				
				<li><a href="../../../../docs/concepts/" class="menuSelected">Concepts</a></li>
			
				
				<li><a href="../../../../docs/actions/">Actions</a></li>
			
				
				<li><a href="../../../../docs/components/">Components</a></li>
			
				
				<li><a href="../../../../docs/integrations/">Integrations</a></li>
			
				
				<li><a href="../../../../docs/tutorials/">Tutorials</a></li>
			
		</ul>
		
	

	

		

		
	

	

		

		
	

	

		

		
	

</div>


		</section>
		<section id="page-content-with-menu">
			
<div id="toc">
     <div class="toc-container">
        
        
        
        
        
            
                
                    
                        
                            
                                    
                                    
                            
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                
            
        
            
                
                    
                        
                    
                        
                    
                
            
        
            
                
                    
                        
                    
                        
                    
                        
                    
                
            
        
            
                
                    
                
            
        
        
        <i class="fa fa-bars" id="tocburger" onclick='$("#toc").toggle()'></i> 
<a class="item" data-title="Concepts" href="../../../../docs/concepts/"></a>

	
	
	
	
		
			
<a class="item" data-title="Authentication" href="../../../../docs/concepts/authentication/"></a>

		
	
		
			
<a class="item" data-title="Job" href="../../../../docs/concepts/job/"></a>

		
	
		
			
<div class="item" data-title="New CDS as Code">
	<div class="container">
		
		<a class="item" data-title="New CDS as Code" href="../../../../docs/concepts/cds_as_code/"></a>
		
		
	
	
	
	
		
			
<div class="item" data-title="Permission">
	<div class="container">
		
		<a class="item" data-title="Permission" href="../../../../docs/concepts/cds_as_code/rbac/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Global roles" href="../../../../docs/concepts/cds_as_code/rbac/global/"></a>

		
	
		
			
<a class="item" data-title="Hatchery roles" href="../../../../docs/concepts/cds_as_code/rbac/hatchery/"></a>

		
	
		
			
<a class="item" data-title="Project roles" href="../../../../docs/concepts/cds_as_code/rbac/project/"></a>

		
	
		
			
<a class="item" data-title="Region roles" href="../../../../docs/concepts/cds_as_code/rbac/region/"></a>

		
	
		
			
<a class="item" data-title="Workflow roles" href="../../../../docs/concepts/cds_as_code/rbac/workflow/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Project">
	<div class="container">
		
		<a class="item" data-title="Project" href="../../../../docs/concepts/cds_as_code/project/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Repository Manager" href="../../../../docs/concepts/cds_as_code/project/repository_manager/"></a>

		
	
		
			
<a class="item" data-title="Repository" href="../../../../docs/concepts/cds_as_code/project/repository/"></a>

		
	
		
			
<a class="item" data-title="VariableSet" href="../../../../docs/concepts/cds_as_code/project/variableset/"></a>

		
	
		
			
<a class="item" data-title="Notification" href="../../../../docs/concepts/cds_as_code/project/notification/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="As code entities">
	<div class="container">
		
		<a class="item" data-title="As code entities" href="../../../../docs/concepts/cds_as_code/entities/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Workflow" href="../../../../docs/concepts/cds_as_code/entities/workflow/"></a>

		
	
		
			
<a class="item" data-title="Action" href="../../../../docs/concepts/cds_as_code/entities/action/"></a>

		
	
		
			
<a class="item" data-title="Worker Model" href="../../../../docs/concepts/cds_as_code/entities/worker_model/"></a>

		
	

	</div>
</div>

		
	
		
			
<a class="item" data-title="Contexts" href="../../../../docs/concepts/cds_as_code/contexts/"></a>

		
	
		
			
<a class="item" data-title="Events" href="../../../../docs/concepts/cds_as_code/events/"></a>

		
	

	</div>
</div>

		
	
		
			
<a class="item" data-title="Project" href="../../../../docs/concepts/project/"></a>

		
	
		
			
<a class="item" data-title="Permissions - ACLs" href="../../../../docs/concepts/permissions/"></a>

		
	
		
			
<a class="item" data-title="Pipeline" href="../../../../docs/concepts/pipeline/"></a>

		
	
		
			
<a class="item" data-title="Organization" href="../../../../docs/concepts/organization/"></a>

		
	
		
			
<a class="item" data-title="Variables" href="../../../../docs/concepts/variables/"></a>

		
	
		
			
<div class="item" data-title="Workflow">
	<div class="container">
		
		<a class="item" data-title="Workflow" href="../../../../docs/concepts/workflow/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Payload" href="../../../../docs/concepts/workflow/payload/"></a>

		
	
		
			
<a class="item" data-title="Pipeline Context" href="../../../../docs/concepts/workflow/pipeline-context/"></a>

		
	
		
			
<div class="item" data-title="Hooks">
	<div class="container">
		
		<a class="item" data-title="Hooks" href="../../../../docs/concepts/workflow/hooks/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Webhook" href="../../../../docs/concepts/workflow/hooks/webhook/"></a>

		
	
		
			
<a class="item" data-title="Scheduler" href="../../../../docs/concepts/workflow/hooks/scheduler/"></a>

		
	
		
			
<a class="item" data-title="Git Repository Webhook" href="../../../../docs/concepts/workflow/hooks/git-repo-webhook/"></a>

		
	
		
			
<a class="item" data-title="Git Repository Poller" href="../../../../docs/concepts/workflow/hooks/git-repo-poller/"></a>

		
	
		
			
<a class="item" data-title="Kafka hook" href="../../../../docs/concepts/workflow/hooks/kafka-hook/"></a>

		
	
		
			
<a class="item" data-title="RabbitMQ hook" href="../../../../docs/concepts/workflow/hooks/rabbitmq-hook/"></a>

		
	
		
			
<a class="item" data-title="Gerrit Hook" href="../../../../docs/concepts/workflow/hooks/gerrit/"></a>

		
	

	</div>
</div>

		
	
		
			
<a class="item" data-title="Run conditions on pipeline" href="../../../../docs/concepts/workflow/run-conditions/"></a>

		
	
		
			
<a class="item" data-title="Join" href="../../../../docs/concepts/workflow/join/"></a>

		
	
		
			
<a class="item" data-title="Mutex" href="../../../../docs/concepts/workflow/mutex/"></a>

		
	
		
			
<a class="item" data-title="Sidebar" href="../../../../docs/concepts/workflow/sidebar/"></a>

		
	
		
			
<a class="item" data-title="Run Number" href="../../../../docs/concepts/workflow/run-number/"></a>

		
	
		
			
<a class="item" data-title="Notifications" href="../../../../docs/concepts/workflow/notifications/"></a>

		
	
		
			
<a class="item" data-title="Retention" href="../../../../docs/concepts/workflow/retention/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Requirement">
	<div class="container">
		
		<a class="item" data-title="Requirement" href="../../../../docs/concepts/requirement/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Region Requirement" href="../../../../docs/concepts/requirement/requirement_region/"></a>

		
	
		
			
<a class="item" data-title="Secret Requirement" href="../../../../docs/concepts/requirement/requirement_secret/"></a>

		
	
		
			
<a class="item" data-title="Service Link" href="../../../../docs/concepts/requirement/requirement_service/"></a>

		
	
		
			
<a class="item" data-title="Memory" href="../../../../docs/concepts/requirement/requirement_memory/"></a>

		
	
		
			
<a class="item" data-title="OS &amp; Architecture" href="../../../../docs/concepts/requirement/requirement_os_arch/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Configuration files">
	<div class="container">
		
		<a class="item" data-title="Configuration files" href="../../../../docs/concepts/files/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="Workflow configuration file" href="../../../../docs/concepts/files/workflow-syntax/"></a>

		
	
		
			
<a class="item" data-title="Pipeline configuration file" href="../../../../docs/concepts/files/pipeline-syntax/"></a>

		
	
		
			
<a class="item" data-title="Worker Model configuration file" href="../../../../docs/concepts/files/worker_model-syntax/"></a>

		
	
		
			
<a class="item" data-title="Action configuration file" href="../../../../docs/concepts/files/action-syntax/"></a>

		
	
		
			
<a class="item" data-title="Application configuration file" href="../../../../docs/concepts/files/application-syntax/"></a>

		
	
		
			
<a class="item" data-title="Environment configuration file" href="../../../../docs/concepts/files/environment-syntax/"></a>

		
	

	</div>
</div>

		
	
		
			
<div class="item" data-title="Worker Model">
	<div class="container">
		
		<a class="item" data-title="Worker Model" href="../../../../docs/concepts/worker-model/"></a>
		
		
	
	
	
	
		
			
<a class="item" data-title="[Experimental] Ascode Worker Model" href="../../../../docs/concepts/worker-model/ascode/"></a>

		
	
		
			
<a class="item" data-title="Worker Model patterns" href="../../../../docs/concepts/worker-model/patterns/"></a>

		
	
		
			
<a class="item" data-title="Worker Model Variables" href="../../../../docs/concepts/worker-model/variables/"></a>

		
	

	</div>
</div>

		
	
		
			
<a class="item" data-title="Workflow Template" href="../../../../docs/concepts/template/"></a>

		
	





     </div>
</div>


			<div id="docsContent">
        		

<h1>Run conditions on pipeline</h1>



<nav id="TableOfContents">
  <ul>
    <li><a href="#basic-run-conditions">Basic run conditions</a></li>
    <li><a href="#advanced-run-conditions">Advanced run conditions</a></li>
  </ul>
</nav>

<p>In CDS if you want to launch a pipeline in your workflow only in specific cases you can add conditions. For example, if you want to run a pipeline automatically only if the value of <code>git.branch</code> is <code>master</code>.</p>
<p>To edit your pipeline condition on the user interface, you have to select a node under edition mode of your workflow and click on <code>Edit run conditions</code> like this:</p>
<p><img src="../../../../images/workflow_pipeline_run_conditions_link.png" alt="Pipeline run conditions link"></p>
<p>There are 2 types of conditions:</p>
<h2 id="basic-run-conditions">Basic run conditions</h2>
<p>With this type of conditions you can add multiple comparisons with a basic operators (<code>=</code>, <code>!=</code>, <code>match</code> for a regular expression, <code>&gt;=</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&lt;</code>). The variables syntax here are dotted syntax (example: <code>cds.dest.application</code>). Under the hood, if you use match operator it uses the Go regexp package, so you can use regular expressions that are supported in the Go regexp package.</p>
<p>If you add multiple basic run conditions, all of these must be satisfied to run the pipeline. So with basic conditions you can&rsquo;t make an <code>OR</code> between multiple conditions, it&rsquo;s always an <code>AND</code>. If you want to make more specific or advanced run conditions you have to use the second type of conditions (<code>advanced</code>).</p>
<p><img src="../../../../images/workflow_pipeline_run_conditions_basic.png" alt="Pipeline basic run conditions"></p>
<h2 id="advanced-run-conditions">Advanced run conditions</h2>
<p>If you want some advanced run conditions, like for example make some computation over specific variables and then compare their values, you have the ability to use advanced run conditions. In fact, you are free to make any computation or comparison because advanced condition is a <a href="http://www.lua.org/">Lua</a> script that returns a boolean (<code>true</code> if you want to run the pipeline or <code>false</code> if you don&rsquo;t). In this case the variables syntax is in Unix case (example: <code>cds_dest_application</code>) and prefixed with <code>cds_</code>, <code>git_</code> or <code>workflow_</code>. In general, <code>.</code> or <code>-</code> in CDS variable name must be replaced with <code>_</code>. For example, if you have a variable named <code>cds.build.my-variable</code> then in Lua you have to use it as <code>cds_build_my_variable</code>.</p>
<p>Pay attention, <em><strong>all types of variables are string</strong></em>. Inside the Lua editor on CDS you have the autocompletion of your variables, you just have to write <code>cds_</code>, <code>git_</code> or <code>workflow_</code> to see suggestions. Please be aware that you can&rsquo;t have at the same time basic conditions and advanced conditions. <em><strong>The behavior when you have both is that ONLY advanced run conditions will be effective</strong></em>.</p>
<p>For example if you want to launch the pipeline if the value of <code>cds_status</code> is <code>Success</code> and <code>git_branch</code> is <code>master</code> OR if the value of <code>cds_manual</code> is <code>true</code> you have to write:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#75715e">-- Pay attention! All variables value are string so you compare cds_manual with the string &#34;true&#34; and not true</span>
<span style="color:#66d9ef">return</span> cds_status <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Success&#34;</span> <span style="color:#f92672">and</span> (git_branch <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;master&#34;</span> <span style="color:#f92672">or</span> cds_manual <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;true&#34;</span>)
</code></pre></div><p>Another use case is to enable auto-prod during working days only (not Saturday and Sunday):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#66d9ef">return</span> os.date(<span style="color:#e6db74">&#34;%w&#34;</span>) <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#34;5&#34;</span>
</code></pre></div><p>Or if you also want to block deployment on your production after 6pm:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#66d9ef">return</span> os.date(<span style="color:#e6db74">&#34;%w&#34;</span>) <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#34;5&#34;</span> <span style="color:#f92672">and</span> os.date(<span style="color:#e6db74">&#34;%H&#34;</span>) <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#34;18&#34;</span>
</code></pre></div><p><img src="../../../../images/workflow_pipeline_run_conditions_advanced.png" alt="Pipeline basic run conditions"></p>
<p>You can also use regular expression in your Lua condition, for instance:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-lua" data-lang="lua"><span style="color:#75715e">-- this example checks if current application beginning with &#39;abc&#39;</span>
<span style="color:#75715e">-- don&#39;t forget to import the regular expression module</span>
<span style="color:#66d9ef">local</span> re <span style="color:#f92672">=</span> require(<span style="color:#e6db74">&#34;re&#34;</span>)

<span style="color:#66d9ef">return</span> re.match(cds_application, <span style="color:#e6db74">&#34;abc.*&#34;</span>) <span style="color:#f92672">==</span> cds_application
</code></pre></div><p>Functions <code>re.find</code>, <code>re.gsub</code>, <code>re.match</code>, <code>re.gmatch</code> are available. These functions have the same API as Lua pattern match.</p>




			</div>
		</section><footer>
			<main>
			<a href="https://www.ovh.com"><img src="https://ovh.github.io/cds/images/logo-ovh-white-72DPI.png"></a>
			<div>
				The CDS logos are copyrighted.
				Icons made by <a href="https://www.flaticon.com/authors/eucalyp">Eucalyp</a> 
				from <a href="https://www.flaticon.com/">www.flaticon.com</a>
			</div>
			</main>
		</footer>

	</body>
</html>
